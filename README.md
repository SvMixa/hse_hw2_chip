# hse_hw2_chip

## Все вычисления производились в Google Colab:
https://colab.research.google.com/drive/1xtBcSZqay1D-3wfnPoW7gk3X-qs1hP9u?usp=sharing

## Данные 
Я выбрал клеточную линию MCF-7 и гистоновую метку H3K4me3.
Реплика 1 - ENCFF211APE

Реплика 2 - ENCFF923ABZ

Контроль - ENCFF640MKX

## Fastqc
| **Реплика 1 (ENCFF211APE)** | **Реплика 2 (ENCFF923ABZ)** | **Контроль (ENCFF640MKX)** |
| ------------- | ------------- |--------------------|
| ![](pic/hw2_6.png) | ![](pic/hw2_1.png) | ![](pic/hw2_7.png) |
| ![](pic/hw2_3.png) | ![](pic/hw2_9.png) | ![](pic/hw2_5.png) |
| ![](pic/hw2_4.png) | ![](pic/hw2_8.png) | ![](pic/hw2_2.png) |

Всего в одном случае потребовалось подрезать файл (в ENCFF923ABZ) так как в отчете fastqc не проходили пунткы "Per base sequence quality", 
"Per tile sequence quality", "Per sequence GC content" и "Per base N content". После обрезания (с помощью программы trimmomatic) ситуация стала гораздо лучше. 

## Результаты

|  | **Реплика 1 (ENCFF211APE)** | **Реплика 2 (ENCFF923ABZ)** | **Контроль (ENCFF640MKX)** |
| ------------- | ------------- |--------------------| ---- |
| Всего ридов | 25022209 | 9726871 | 40520604 |
| Не выровнено | 21345405 (85.31%) | 8424629 (86.61%) | 34462122 (85.05%) |
| Выровнено 1 раз | 953167 (3.81%) | 382282 (3.93%) | 1095534 (2.70%) |
| Выровнено больше 1 раза | 2723637 (10.88%) | 919960 (9.46%) | 4962948 (12.25%) |


Такие проценты стоило ожидать, так как мы выравниваем только на 1 хромосому. Если бы хромосомы были одинаковые по размеру, то процент невыровненых ридов стремился бы к 95. Однако размеры хромосом отличаются, поэтому мы получили 85%. Процент выровненых больше 1 раза в несколько раз больше уникальных, так как есть фиксированные последовательности, которые часто встречаются в геноме.

## Диаграммы Венна 
|  | **Пересечение пиков с ENCODE** | **Пересечение ENCODE с пиками** |
| ------------- | ------------- |--------------------|
| Реплика 1 (ENCFF211APE) | ![](pic/venn_4.png) | ![](pic/venn_1.png) |
| Реплика 2 (ENCFF923ABZ) | ![](pic/venn_2.png) | ![](pic/venn_3.png) |

Опять же, мы выравниваем только на 1 хромосому, поэтому имеем низкий процент пересечений. 


## Бонус
Для гистоновой метки H3K4me3 хотим проверить результат, представленный на рисунке ниже.
![](pic/bonus_teor.png)

Получим два графика:
| |  |
| ------------- | ------------- |
| ![](pic/result.png) | ![](pic/result_2.png) |

Мы видим, что первый пик хорошо согласуется с результатом с картинки. Однако в наших экспериментах появляется еще вторая полоса. Скорее всего это не артефакт, так как на обоих файлах она заметна, хоть и сильно меньше во втором. Полученное положение гистоновых меток только на половину совпадает с экспериментом из ENCODE. 
